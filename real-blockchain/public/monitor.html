<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>PharbitChain Monitor</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(280px,1fr)); gap: 16px; }
    .card { border: 1px solid #ddd; border-radius: 8px; padding: 12px; }
    h3 { margin: 0 0 8px 0; }
    code { font-family: monospace; font-size: 12px; }
  </style>
  <script>
    async function load() {
      const res = await fetch('/api/health');
      const data = await res.json();
      document.getElementById('blocks').textContent = data.blockchain.blocks;
      document.getElementById('pending').textContent = data.blockchain.pendingTransactions;
      document.getElementById('isValid').textContent = data.blockchain.isValid;
      document.getElementById('avgApi').textContent = data.metrics.avgApiMs + ' ms';
      document.getElementById('avgMining').textContent = data.metrics.avgMiningMs + ' ms';
      document.getElementById('txProcessed').textContent = data.metrics.txProcessed;
      document.getElementById('rss').textContent = (data.system.rss/1048576).toFixed(1) + ' MB';
      document.getElementById('heap').textContent = (data.system.heapUsed/1048576).toFixed(1) + ' MB';
      document.getElementById('load').textContent = JSON.stringify(data.system.cpuLoadAvg);
      document.getElementById('db').textContent = data.db.initialized + ' (' + data.db.path + ')';
      document.getElementById('raw').textContent = JSON.stringify(data, null, 2);
    }
    setInterval(load, 3000);
    window.onload = load;
  </script>
  </head>
<body>
  <h2>PharbitChain Monitor</h2>
  <div class="grid">
    <div class="card">
      <h3>Blockchain</h3>
      <div>Blocks: <b id="blocks">-</b></div>
      <div>Pending: <b id="pending">-</b></div>
      <div>Valid: <b id="isValid">-</b></div>
    </div>
    <div class="card">
      <h3>Performance</h3>
      <div>Avg API: <b id="avgApi">-</b></div>
      <div>Avg Mining: <b id="avgMining">-</b></div>
      <div>Tx processed: <b id="txProcessed">-</b></div>
    </div>
    <div class="card">
      <h3>System</h3>
      <div>RSS: <b id="rss">-</b></div>
      <div>Heap: <b id="heap">-</b></div>
      <div>LoadAvg: <code id="load">-</code></div>
    </div>
    <div class="card">
      <h3>Database</h3>
      <div>Status: <b id="db">-</b></div>
    </div>
  </div>
  <h3>Raw Health</h3>
  <pre><code id="raw">{}</code></pre>
</body>
</html>

